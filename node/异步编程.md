## 异步编程

##### 回调函数

不成立情况：

```javascript
function add(x,y){
    console.log(1)
    setTimeout(function(){
        console.log(2)
        let ret = x + y
        return ret
    },1000)
    console.log(3)
    // 到这里执行就结束了，不会等到前面的定时器，所以直接就返回默认值undefined
}

console.log(add(10,20)) // => undefined
```

不成立情况：

```javascript
function add(x,y){
    let ret
    console.log(1)
    setTimeout(function(){
        console.log(2)
        ret = x + y
        return ret
    },1000)
    console.log(3)
    return ret
}

console.log(add(10,20)) // => undefined
```

回调函数：

```javascript
function add(x,y,callback){
    // callback 就是回调函数
    // let x = 10
    // let y = 20
    // let callback = function (ret) { console.log(ret) }
    console.log(1)
    setTimeout(function(){
        let ret = x + y
        callback(ret)
    },1000)
}

add(10,20,function(ret){
    console.log(ret)
})
```

基于原生 XMLHTTPRequest 封装 get 方法：

```javascript
function get(url,callback){
    let oReq = new XMLHttpRequest()
    // 当请求加载成功之后要调用指定的函数
    oReq.onload = function(){
        // 需要得到这里的 oReq.responseText
        callback(oReq.responseText)
    }
    oReq.open('get',url,true)
    oReq.send()
}

get('data.json',function(data){
    console.log(data)
})
```

